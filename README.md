# π§© λ―Έλ΅ κ²μ„ κµ¬ν„ (Dedicated Server κΈ°λ°)

> μ΄ ν”„λ΅μ νΈλ” **μ–Έλ¦¬μ–Ό μ—”μ§„μ Dedicated Server κµ¬μ΅°**λ¥Ό ν™μ©ν•μ—¬, μλ™μΌλ΅ λ―Έλ΅λ¥Ό μƒμ„±ν•κ³ , ν”λ μ΄μ–΄κ°€ λ„μ°© μ§€μ μ— λ„λ‹¬ν•λ©΄ κ²μ„μ΄ μΆ…λ£λλ” λ°©μ‹μΌλ΅ κµ¬μ„±λ λ©€ν‹°ν”λ μ΄ κ²μ„μ…λ‹λ‹¤.

<br>

## π“ ν”„λ΅μ νΈ κ°μ”

- **ν”„λ΅μ νΈ λ…**: Maze Escape Game
- **κ°λ° ν™κ²½**: Unreal Engine 5.54, C++
- **μ„λ²„ κµ¬μ΅°**: Dedicated Server
- **ν•µμ‹¬ κΈ°λ¥**:
  - DFS κΈ°λ° μλ™ λ―Έλ΅ μƒμ„± μ‹μ¤ν…
  - κ°€μ¥ κΉμ€ μ…€μ„ λ©ν‘ μ§€μ μΌλ΅ μ§€μ •
  - μ„λ²„-ν΄λΌμ΄μ–ΈνΈ κµ¬μ΅°μ— λ§μ¶ λ΅μ§ λ° ν΄λμ¤ μ„¤κ³„
  - ν”λ μ΄μ–΄ κ°„ κ²½μ κµ¬μ΅° (λ¨Όμ € λ„μ°©ν• μ‚¬λμ΄ μΉλ¦¬)
 
<br>

## π–¥οΈ Dedicated Server κµ¬μ΅°μ νΉμ§•

λ³Έ ν”„λ΅μ νΈλ” **Listen Serverκ°€ μ•„λ‹ μ™„μ „ν• Dedicated Server** ν™κ²½μ„ κΈ°λ°μΌλ΅ μ μ‘λμ—μµλ‹λ‹¤.  
Dedicated Serverλ” ν΄λΌμ΄μ–ΈνΈμ™€ λ³„κ°λ΅ λ™μ‘ν•λ” λ…λ¦½ μ„λ²„ ν”„λ΅μ„Έμ¤λ΅, κ²μ„μ λ¨λ“  μƒνƒμ™€ λ΅μ§μ„ μ„λ²„μ—μ„ authoritativeν•κ² μ²λ¦¬ν•©λ‹λ‹¤.

### β… μ„¤κ³„ μλ„ λ° μ¥μ 
- μ„λ²„κ°€ λ¨λ“  κ²μ„ λ΅μ§μ„ μ†μ ν•λ―€λ΅ **μΉνΈ λ° λ™κΈ°ν™” μ¤λ¥ λ°©μ§€**
- **ν΄λΌμ΄μ–ΈνΈλ” λ‹¨μ μ…λ ¥/μ¶λ ¥ μ²λ¦¬**, λ΅μ§ κ²°μ •μ€ μ „μ μΌλ΅ μ„λ²„ λ‹΄λ‹Ή
- μ¶”ν›„ **λ§¤μΉλ©”μ΄ν‚Ή, λ΅λΉ„ μ‹μ¤ν… μ—°κ³„** μ‹ ν™•μ¥μ„± ν™•λ³΄

### β… κ΄€λ ¨ ν΄λμ¤ μ„¤κ³„ κµ¬μ΅°
| ν΄λμ¤ | μ—­ν•  |
|--------|------|
| `AEscapeFromMazeGameMode` | μ„λ²„ μ „μ©. μ ‘μ†μ μ²λ¦¬ λ° κ²μ„ νλ¦„, μΉν¨ λ΅μ§ μ μ–΄ |
| `AEFM_GameState` | μ„λ²„/ν΄λΌμ΄μ–ΈνΈ κ³µμ©. μ‹μ‘ μ„μΉ, Maze μƒνƒ λ“± κ³µμ  λ°μ΄ν„° κ΄€λ¦¬ |
| `AEFM_PlayerState` | ν”λ μ΄μ–΄ κ³ μ  μ •λ³΄(λ‹‰λ„¤μ„ λ“±)λ¥Ό μ„λ²„μ—μ„ κ΄€λ¦¬ν•κ³  ν΄λΌμ΄μ–ΈνΈλ΅ λ³µμ  |
| `AEFM_PlayerController` | ν΄λΌμ΄μ–ΈνΈ μ…λ ¥ μμ§‘, μ„λ²„ RPC νΈμ¶, HUD κ°±μ‹  λ“± μ²λ¦¬ |

<br>

<br>

## π§± μ „μ²΄ μ‹μ¤ν… κµ¬μ΅° λ° ν΄λμ¤ νλ¦„λ„

### 1. λ―Έλ΅ μƒμ„± κµ¬μ΅°
- `FMazeCell`: μ…€ κµ¬μ΅°λ¥Ό μ •μν•λ” κµ¬μ΅°μ²΄ (λ°©λ¬Έ μ—¬λ¶€, λ²½ 4λ°©ν–¥)
- `MazeData`: μ „μ²΄ λ―Έλ΅λ¥Ό μ €μ¥ν•λ” 2D λ°°μ—΄
- `AMazeGenerator`: λ―Έλ΅ λ°μ΄ν„°λ¥Ό μƒμ„±ν•κ³  κ²μ„μ— λ°°μΉν•λ” ν΄λμ¤

### 2. κ²μ„ μ§„ν–‰ νλ¦„
- μ„λ²„μ—μ„ κ²μ„ μ‹μ‘ μ‹, μλ™μΌλ΅ λ―Έλ΅λ¥Ό μƒμ„±
- κ°€μ¥ κΉμ€ μ…€μ„ λ©ν‘ μ§€μ μΌλ΅ μ„¤μ •
- ν”λ μ΄μ–΄λ” μ„μμ μ„μΉμ—μ„ κ°™μ΄ μ‹μ‘ν•μ—¬ λ©ν‘ μ§€μ μ„ νƒμƒ‰ λ° μ΄λ™
- μµμ΄ ν• λ…μ΄ λ©ν‘ λ„λ‹¬ μ‹, μΉμ νμ • ν›„ κ²μ„ μΆ…λ£

<br>

## π§® λ―Έλ΅ μƒμ„± μ•κ³ λ¦¬μ¦

- DFS κΈ°λ° μ¬κ·€ μ•κ³ λ¦¬μ¦μΌλ΅ λ―Έλ΅λ¥Ό μƒμ„±
- λ°©λ¬Έν•μ§€ μ•μ€ μ…€μ„ λλ¤ν•κ² λ°©λ¬Έν•λ©° κ²½λ΅ μƒμ„±
- κ°€μ¥ κΉμ΄ λ„λ‹¬ν• μ…€μ„ `GoalPoint`λ΅ μ„¤μ •ν•΄ λ„μ°© μ§€μ  μ§€μ •
- κ° μ…€μ€ λ„¤ λ°©ν–¥ λ²½ μƒνƒλ¥Ό μ €μ¥ν•λ©°, μΈμ ‘ μ…€κ³Ό μ—°κ²° μ‹ ν•΄λ‹Ή λ²½μ„ μ κ±°

<br>

## π”„ λ°μ΄ν„° ν†µμ‹  λ° λ™κΈ°ν™”

### π“ κ²μ„ μ „μ²΄ νλ¦„μ— λ”°λ¥Έ ν΄λμ¤ μ—­ν•  μ”μ•½

**μ„λ²„ μ‹μ‘ μ‹ β†’ λ―Έλ΅ μƒμ„±κΈ° λ™μ‘**

```
AMazeGenerator::InitMazeData()
β†’ λ―Έλ΅ μ…€ μ΄κΈ°ν™” (FMazeCell 2D λ°°μ—΄)

AMazeGenerator::GenerateMaze()
β†’ μ¬κ·€ λ°±νΈλν‚Ή μ•κ³ λ¦¬μ¦μΌλ΅ λ―Έλ΅ μƒμ„±
β†’ κ°€μ¥ κΉκ² λ„λ‹¬ν• μ…€μ„ GoalPointλ΅ μ €μ¥

AMazeGenerator::SpawnMazeActors(), SpawnGoalActor()
β†’ μ›”λ“μ— λ²½κ³Ό λ μ  Actor μƒμ„±
β†’ μ‹μ‘ μ„μΉλ” AEFM_GameStateμ— μ €μ¥
```

**ν”λ μ΄μ–΄ μ ‘μ† β†’ μ„λ²„ μ²λ¦¬**

```
AEscapeFromMazeGameMode::PostLogin()
β†’ μΌμ • μ‹κ°„ λ”λ μ΄ ν›„ AssignStartLocation() νΈμ¶
β†’ GameStateμ— μ €μ¥λ StartLocation κΈ°λ°μΌλ΅ μ„μΉ κ³„μ‚°
β†’ AEscapeFromMazeCharacter::SetActorLocation() λλ” Client_MoveToStart() νΈμ¶
```

**ν΄λΌμ΄μ–ΈνΈμ—μ„ λ‹‰λ„¤μ„ μ…λ ¥**

```
UMG μ„μ ― β†’ OnTextCommitted()
β†’ AEFM_PlayerController::Server_SetPlayerNickname()
β†’ AEFM_PlayerState::SetPlayerNickname() β†’ Replicated
β†’ ν΄λΌμ΄μ–ΈνΈμ— μ΄λ¦„ λ™κΈ°ν™”
```

**κ³¨ λ„λ‹¬ μ‹ μ²λ¦¬**

```
AGoalPoint::NotifyActorBeginOverlap()
β†’ AEscapeFromMazeGameMode::EndGame() νΈμ¶
β†’ μΉμ μ΄λ¦„ λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ— μ „λ‹¬
β†’ AEFM_PlayerController::Client_ReachedGoal() β†’ HUD μ—…λ°μ΄νΈ
```

**κ²μ„ μΆ…λ£**

```
AEscapeFromMazeGameMode::ExitGame()
β†’ λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ AEFM_PlayerController::Client_ExitGame() νΈμ¶
β†’ λ λ²¨ μΆ…λ£ λλ” κ²μ„ μΆ…λ£ μ²λ¦¬
```

<br>

## π§­ κµ¬μ΅° μ”μ•½

### π§© λ―Έλ΅ κ΄€λ ¨
| κµ¬μ„± μ”μ† | μ„¤λ… |
|-----------|------|
| `FMazeCell` | μ…€ ν•λ‚μ λ²½ μ •λ³΄ λ° λ°©λ¬Έ μ—¬λ¶€ μ •μ |
| `MazeData` | `FMazeCell`μ„ κΈ°λ°μΌλ΅ κµ¬μ„±λ 2μ°¨μ› λ°°μ—΄ λ―Έλ΅ λ°μ΄ν„° |
| `AMazeGenerator` | `MazeData` μ΄κΈ°ν™” λ° DFSλ¥Ό ν†µν• λ―Έλ΅ μƒμ„±, κ³¨ μ§€μ  κ²°μ • |
| `GoalPoint` | DFSλ΅ μƒμ„±λ μµμΆ… λ©μ μ§€ μΆν‘, ν•΄λ‹Ή μ„μΉμ— κ³¨μΈ μ•΅ν„° λ°°μΉ |

### π§β€β™‚οΈ ν”λ μ΄μ–΄ κ΄€λ ¨
| κµ¬μ„± μ”μ† | μ„¤λ… |
|-----------|------|
| `AEFM_PlayerController` | μ…λ ¥ μ²λ¦¬, ν΄λΌμ΄μ–ΈνΈ HUD λ° μƒνƒ μ μ–΄ |
| `AEFM_PlayerState` | ν”λ μ΄μ–΄ λ‹‰λ„¤μ„ λ“± κ³ μ  μ •λ³΄ μ €μ¥, μΉμ ν‘μ‹μ— ν™μ© |
| `AEscapeFromMazeCharacter` | μ‹¤μ  μ›”λ“μ— μ΅΄μ¬ν•λ” ν”λ μ΄μ–΄ μΊλ¦­ν„° Actor |

### π® κ²μ„ νλ¦„ κ΄€λ ¨
| κµ¬μ„± μ”μ† | μ„¤λ… |
|-----------|------|
| `AEscapeFromMazeGameMode` | ν”λ μ΄μ–΄ μ ‘μ† λ° μ‹μ‘ μ„μΉ λ°°μΉ, κ²μ„ μΉν¨ μ²λ¦¬ λ‹΄λ‹Ή |
| `AEFM_GameState` | λ¨λ“  ν”λ μ΄μ–΄κ°€ κ³µμ ν•λ” μ‹μ‘ μ„μΉ, λ―Έλ΅ μƒνƒ λ“± κ²μ„ λ°μ΄ν„° μ €μ¥ |

<br>

## π“ κ΄€λ ¨ λ§ν¬

- π”— [κ°λ° λΈ”λ΅κ·Έ μ›λ¬Έ λ³΄κΈ°](https://dong-grae.tistory.com/206)
